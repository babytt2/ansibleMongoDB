systemLog:
  verbosity: 0
  path: {{ mongodb_systemlog_path }}
  logAppend: {{ mongodb_systemlog_logappend }}
  logRotate: {{ mongodb_systemlog_logrotate }}
  destination: {{ mongodb_systemlog_destination }}

processManagement:
  fork: {{ mongodb_processmanagement_fork }}
{% if mongodb_pidfile_path is defined and mongodb_pidfile_path != '' %}
  pidFilePath: {{ mongodb_pidfile_path }}
{% endif %}

net:
  port: {{ mongodb_net_port }}
  bindIp: {{ mongodb_net_bindip }}
  maxIncomingConnections: {{ mongodb_net_maxconns | int }}
  wireObjectCheck: true
  ipv6: {{ mongodb_net_ipv6 | to_nice_json }}
  compression:
{% if mongodb_version < 4.2 %}
    compressors: {{ mongodb_net_compressors }}
{% else %}
    compressors: zstd
{% endif %}



security:
  authorization: disabled

storage:
  dbPath: {{ mongodb_storage_dbpath }}
  directoryPerDB: {{ mongodb_storage_dirperdb }}
  journal:
    enabled: {{ mongodb_storage_journal_enabled }}
  engine: {{ mongodb_storage_engine }}
  wiredTiger:
    engineConfig:
{% if ansible_memtotal_mb <= 4*1024 %}
      cacheSizeGB: 0.25
{% else %}
      cacheSizeGB: {{ mongodb_engine_cachesizegb }}
{% endif %}

operationProfiling:
  mode: off
  slowOpThresholdMs: 100
  slowOpSampleRate: 1.0

{% if mongodb_set_parameters %}
setParameter:
{% for key, value in mongodb_set_parameters.items() %}
  {{ key }}: {{ value }}
{% endfor %}
{% endif %}
